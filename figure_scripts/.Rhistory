return(pl)
}
plot_list_total_rate_RC <- c()
plot_list_S_rate <- c()
plot_list_N_rate <- c()
for(scenario in c('2c','2d','2e','3a','3b','3c')){
file_path <- paste('../results/rates_vs_time/simulated_alignments/scenario',
scenario, '_rep1/scenario', scenario, '_rep1_rates_vs_time_correlations.csv', sep = '')
results_dataframe <- read.table(file_path, header = T, sep = ',')
plot_list_total_rate_RC[[scenario]] <- base_plot_time(results_dataframe, 'total_rate_RC')
plot_list_S_rate[[scenario]] <- base_plot_time(results_dataframe, 'S_rate')
plot_list_N_rate[[scenario]] <- base_plot_time(results_dataframe, 'N_rate')
}
# Plot with results from uniform mutability simulations, w/ 30 (2c), 40 (2d) and 50% (2e) decrease in total rate
uniform_mutability_plot <- plot_grid(plot_list_total_rate_RC[['2c']],plot_list_S_rate[['2c']], plot_list_N_rate[['2c']],
plot_list_total_rate_RC[['2d']],plot_list_S_rate[['2d']], plot_list_N_rate[['2d']],
plot_list_total_rate_RC[['2e']],plot_list_S_rate[['2e']], plot_list_N_rate[['2e']])
save_plot("rates_vs_time_uniform.pdf", uniform_mutability_plot,
base_height = 15, base_width = 20
)
save_plot("rates_vs_time_uniform.pdf", uniform_mutability_plot,
base_height = 10, base_width = 12
)
?plot_grid
uniform_mutability_30 <- plot_grid(plot_list_total_rate_RC[['2c']],plot_list_S_rate[['2c']], plot_list_N_rate[['2c']],
labels = c('20% simulated decrease','',''))
uniform_mutability_30
uniform_mutability_plot <- plot_grid(plot_list_total_rate_RC[['2c']],plot_list_S_rate[['2c']], plot_list_N_rate[['2c']],
plot_list_total_rate_RC[['2d']],plot_list_S_rate[['2d']], plot_list_N_rate[['2d']],
plot_list_total_rate_RC[['2e']],plot_list_S_rate[['2e']], plot_list_N_rate[['2e']],
labels = c('', '20% simulated decrease','','', '40% simulated decrease','','', '50% simulated decrease','')
)
save_plot("rates_vs_time_uniform.pdf", uniform_mutability_plot,
base_height = 10, base_width = 12
)
save_plot("rates_vs_time_uniform.pdf", uniform_mutability_plot,
base_height = 7, base_width = 7
)
save_plot("rates_vs_time_uniform.pdf", uniform_mutability_plot,
base_height = 10, base_width = 10
)
save_plot("rates_vs_time_uniform.pdf", uniform_mutability_plot,
base_height = 10, base_width = 11
)
nonuniform_mutability_plot <- plot_grid(plot_list_total_rate_RC[['3a']],plot_list_S_rate[['3a']], plot_list_N_rate[['3a']],
plot_list_total_rate_RC[['3b']],plot_list_S_rate[['3b']], plot_list_N_rate[['3b']],
plot_list_total_rate_RC[['3c']],plot_list_S_rate[['3c']], plot_list_N_rate[['3c']],
labels = c('', 'S5F-based model','','', 'Hotspot-based model (3x)','','', 'Hotspot-based model (30x)','')
)
save_plot("rates_vs_time_nonuniform.pdf", uniform_mutability_plot,
base_height = 10, base_width = 11
)
save_plot("rates_vs_time_nonuniform.pdf", nonuniform_mutability_plot,
base_height = 10, base_width = 11
)
save_plot("rates_vs_time_nonuniform.pdf", nonuniform_mutability_plot,
base_height = 10, base_width = 12
)
uniform_mutability_plot <- plot_grid(plot_list_total_rate_RC[['2c']],plot_list_S_rate[['2c']], plot_list_N_rate[['2c']],
plot_list_total_rate_RC[['2d']],plot_list_S_rate[['2d']], plot_list_N_rate[['2d']],
plot_list_total_rate_RC[['2e']],plot_list_S_rate[['2e']], plot_list_N_rate[['2e']],
labels = c('', '30% simulated decrease','','', '40% simulated decrease','','', '50% simulated decrease','')
)
save_plot("rates_vs_time_uniform.pdf", uniform_mutability_plot,
base_height = 10, base_width = 11
)
rm(list=ls(all=T))
ggplot() +
# Internal: black (grey25), Terminal: 'royalblue1'
scale_colour_manual(values=c("grey25",'royalblue1')) +
xlab(paste("Time since MRCA (", time_units, ')', sep = '')) +
ylab(ylabel) +
ggplot_theme +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_blank(),
plot.title = element_text(hjust = 0.5, size = 10),
plot.margin = unit(c(1, 1, 1, 1),"cm")) +
scale_y_continuous(label=scientific_10)
time_units <- 'weeks'
ggplot() +
# Internal: black (grey25), Terminal: 'royalblue1'
scale_colour_manual(values=c("grey25",'royalblue1')) +
xlab(paste("Time since MRCA (", time_units, ')', sep = '')) +
ylab(ylabel) +
ggplot_theme +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_blank(),
plot.title = element_text(hjust = 0.5, size = 10),
plot.margin = unit(c(1, 1, 1, 1),"cm")) +
scale_y_continuous(label=scientific_10)
ylabel <- 'Total substitution rate'
ggplot() +
# Internal: black (grey25), Terminal: 'royalblue1'
scale_colour_manual(values=c("grey25",'royalblue1')) +
xlab(paste("Time since MRCA (", time_units, ')', sep = '')) +
ylab(ylabel) +
ggplot_theme +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_blank(),
plot.title = element_text(hjust = 0.5, size = 10),
plot.margin = unit(c(1, 1, 1, 1),"cm")) +
scale_y_continuous(label=scientific_10)
source('ggplot_parameters.R')
ggplot() +
# Internal: black (grey25), Terminal: 'royalblue1'
scale_colour_manual(values=c("grey25",'royalblue1')) +
xlab(paste("Time since MRCA (", time_units, ')', sep = '')) +
ylab(ylabel) +
ggplot_theme +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_blank(),
plot.title = element_text(hjust = 0.5, size = 10),
plot.margin = unit(c(1, 1, 1, 1),"cm")) +
scale_y_continuous(label=scientific_10)
scientific_10 <- function(x) {
parse(text=gsub("e", " %*% 10^", scientific_format()(x)))
}
library('ggplot2')
library('reshape')
library('gridExtra')
library('grid')
library('coda')
library('scales')
library('cowplot')
ggplot() +
# Internal: black (grey25), Terminal: 'royalblue1'
scale_colour_manual(values=c("grey25",'royalblue1')) +
xlab(paste("Time since MRCA (", time_units, ')', sep = '')) +
ylab(ylabel) +
ggplot_theme +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_blank(),
plot.title = element_text(hjust = 0.5, size = 10),
plot.margin = unit(c(1, 1, 1, 1),"cm")) +
scale_y_continuous(label=scientific_10)
x <- c('a','b','c')
paste('Letra ', x, sep = '')
paste('Letra ', x,  sep = '')
paste('Letra ', x, ',', sep = '')
results_directory <- '..../results/rates_vs_time/observed_lineages/'
paths <- c('CH103_constant/CH103_con_run1a', 'CH103L_constant/CH103L_con_run1a',
'VRC26int_constant/VRC26int_con_run1a','VRC26L_constant/VRC26L_con_run1a',
'VRC01_13_logistic/VRC01_13_log_run1a','VRC01_01_logistic/VRC01_01_log_run1a',
'VRC01_19_logistic/VRC01_19_log_run1a'
)
paths <- paste(results_directory,paths,'_rates_vs_time_points.csv')
paths
results_directory <- '../results/rates_vs_time/observed_lineages/'
paths <- c('CH103_constant/CH103_con_run1a', 'CH103L_constant/CH103L_con_run1a',
'VRC26int_constant/VRC26int_con_run1a','VRC26L_constant/VRC26L_con_run1a',
'VRC01_13_logistic/VRC01_13_log_run1a','VRC01_01_logistic/VRC01_01_log_run1a',
'VRC01_19_logistic/VRC01_19_log_run1a'
)
paths <- paste(results_directory,paths,'_rates_vs_time_points.csv')
paths
results_directory <- '../results/rates_vs_time/observed_lineages/'
paths <- c('CH103_constant/CH103_con_run1a', 'CH103L_constant/CH103L_con_run1a',
'VRC26int_constant/VRC26int_con_run1a','VRC26L_constant/VRC26L_con_run1a',
'VRC01_13_logistic/VRC01_13_log_run1a','VRC01_01_logistic/VRC01_01_log_run1a',
'VRC01_19_logistic/VRC01_19_log_run1a'
)
paths <- paste(results_directory,paths,'_rates_vs_time_points.csv', sep = '')
paths
29 * 12
i <- 1
clone_labels <- c('CH103 (H)', 'CH103 (L)', 'VRC26 (H)', 'VRC26 (L)',
'VRC01-13 (H)', 'VRC01-01 (H)', 'VRC01-19 (H)')
time_units <- c('weeks','weeks','weeks','weeks','months','months','months')
file_path[i]
(paths[i]
)
results_dataframe <- read.table(paths[i], header = T, sep = ',')
time_units <- 'weeks'
rate <- 'total_rate_RC'
# Sample of 100 trees
sample_size <- 100
tree_sample <- sample(unique(results_dataframe$tree), sample_size, replace = F)
ylabel <- switch(rate,
total_rate = "Total substitution rate",
total_rate_RC = "Total substitution rate (RC)",
S_rate = "Synonymous substitution rate",
N_rate = "Non-synonymous rate")
pl <- ggplot() +
# Internal: black (grey25), Terminal: 'royalblue1'
scale_colour_manual(values=c("grey25",'royalblue1')) +
xlab(paste("Time since MRCA (", time_units, ')', sep = '')) +
ylab(ylabel) +
ggplot_theme +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_blank(),
plot.title = element_text(hjust = 0.5, size = 10),
plot.margin = unit(c(1, 1, 1, 1),"cm")) +
scale_y_continuous(label=scientific_10)
for(tree in tree_sample){
dataframe_subset <- results_dataframe[results_dataframe$tree == tree,]
x <- dataframe_subset[,'parent_time']
y <- dataframe_subset[,paste(rate,'_to_child',sep='')]
factor <- factor(dataframe_subset[,'branch_is_terminal'])
pl <- pl + geom_point(data=data.frame(x,y,factor),
aes(x=x,y=y, colour = factor),
size = 4, alpha = 0.8)
}
pl
pl <- ggplot() +
# Internal: black (grey25), Terminal: 'royalblue1'
scale_colour_manual(values=c("grey25",'royalblue1')) +
xlab(paste("Time since MRCA (", time_units, ')', sep = '')) +
ylab(ylabel) +
ggplot_theme +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_blank(),
plot.title = element_text(hjust = 0.5, size = 10),
plot.margin = unit(c(1, 1, 1, 1),"cm")) +
scale_y_continuous(label=scientific_10, expand = c(0,0)) +
scale_x_continuous(expand = c(0,0) )
for(tree in tree_sample){
dataframe_subset <- results_dataframe[results_dataframe$tree == tree,]
x <- dataframe_subset[,'parent_time']
y <- dataframe_subset[,paste(rate,'_to_child',sep='')]
factor <- factor(dataframe_subset[,'branch_is_terminal'])
pl <- pl + geom_point(data=data.frame(x,y,factor),
aes(x=x,y=y, colour = factor),
size = 4, alpha = 0.8)
}
pl
pl <- ggplot() +
# Internal: black (grey25), Terminal: 'royalblue1'
scale_colour_manual(values=c("grey25",'royalblue1')) +
xlab(paste("Time since MRCA (", time_units, ')', sep = '')) +
ylab(ylabel) +
ggplot_theme +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_blank(),
plot.title = element_text(hjust = 0.5, size = 10),
plot.margin = unit(c(1, 1, 1, 1),"cm")) +
scale_y_continuous(label=scientific_10, expand = c(0,0.1)) +
scale_x_continuous(expand = c(0,0) )
for(tree in tree_sample){
dataframe_subset <- results_dataframe[results_dataframe$tree == tree,]
x <- dataframe_subset[,'parent_time']
y <- dataframe_subset[,paste(rate,'_to_child',sep='')]
factor <- factor(dataframe_subset[,'branch_is_terminal'])
pl <- pl + geom_point(data=data.frame(x,y,factor),
aes(x=x,y=y, colour = factor),
size = 4, alpha = 0.8)
}
pl
pl <- ggplot() +
# Internal: black (grey25), Terminal: 'royalblue1'
scale_colour_manual(values=c("grey25",'royalblue1')) +
xlab(paste("Time since MRCA (", time_units, ')', sep = '')) +
ylab(ylabel) +
ggplot_theme +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_blank(),
plot.title = element_text(hjust = 0.5, size = 10),
plot.margin = unit(c(1, 1, 1, 1),"cm")) +
scale_y_continuous(label=scientific_10, expand = c(0,0.01)) +
scale_x_continuous(expand = c(0,0) )
for(tree in tree_sample){
dataframe_subset <- results_dataframe[results_dataframe$tree == tree,]
x <- dataframe_subset[,'parent_time']
y <- dataframe_subset[,paste(rate,'_to_child',sep='')]
factor <- factor(dataframe_subset[,'branch_is_terminal'])
pl <- pl + geom_point(data=data.frame(x,y,factor),
aes(x=x,y=y, colour = factor),
size = 4, alpha = 0.8)
}
pl
ggplot() +
# Internal: black (grey25), Terminal: 'royalblue1'
scale_colour_manual(values=c("grey25",'royalblue1')) +
xlab(paste("Time since MRCA (", time_units, ')', sep = '')) +
ylab(ylabel) +
ggplot_theme +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_blank(),
plot.title = element_text(hjust = 0.5, size = 10),
plot.margin = unit(c(1, 1, 1, 1),"cm")) +
scale_y_continuous(label=scientific_10, expand = c(0,0.001)) +
scale_x_continuous(expand = c(0,0) )
pl <- ggplot() +
# Internal: black (grey25), Terminal: 'royalblue1'
scale_colour_manual(values=c("grey25",'royalblue1')) +
xlab(paste("Time since MRCA (", time_units, ')', sep = '')) +
ylab(ylabel) +
ggplot_theme +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_blank(),
plot.title = element_text(hjust = 0.5, size = 10),
plot.margin = unit(c(1, 1, 1, 1),"cm")) +
scale_y_continuous(label=scientific_10, expand = c(0,0.001)) +
scale_x_continuous(expand = c(0,0) )
for(tree in tree_sample){
dataframe_subset <- results_dataframe[results_dataframe$tree == tree,]
x <- dataframe_subset[,'parent_time']
y <- dataframe_subset[,paste(rate,'_to_child',sep='')]
factor <- factor(dataframe_subset[,'branch_is_terminal'])
pl <- pl + geom_point(data=data.frame(x,y,factor),
aes(x=x,y=y, colour = factor),
size = 4, alpha = 0.8)
}
pl
pl
pl <- ggplot() +
# Internal: black (grey25), Terminal: 'royalblue1'
scale_colour_manual(values=c("grey25",'royalblue1')) +
xlab(paste("Time since MRCA (", time_units, ')', sep = '')) +
ylab(ylabel) +
ggplot_theme +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_blank(),
plot.title = element_text(hjust = 0.5, size = 10),
plot.margin = unit(c(1, 1, 1, 1),"cm")) +
scale_y_continuous(label=scientific_10, expand = c(0.001,0.001)) +
scale_x_continuous(expand = c(0.005,0.005) )
for(tree in tree_sample){
dataframe_subset <- results_dataframe[results_dataframe$tree == tree,]
x <- dataframe_subset[,'parent_time']
y <- dataframe_subset[,paste(rate,'_to_child',sep='')]
factor <- factor(dataframe_subset[,'branch_is_terminal'])
pl <- pl + geom_point(data=data.frame(x,y,factor),
aes(x=x,y=y, colour = factor),
size = 4, alpha = 0.8)
}
pl
pl <- ggplot() +
# Internal: black (grey25), Terminal: 'royalblue1'
scale_colour_manual(values=c("grey25",'royalblue1')) +
xlab(paste("Time since MRCA (", time_units, ')', sep = '')) +
ylab(ylabel) +
ggplot_theme +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_blank(),
plot.title = element_text(hjust = 0.5, size = 10),
plot.margin = unit(c(1, 1, 1, 1),"cm")) +
scale_y_continuous(label=scientific_10, expand = c(0.005,0.005)) +
scale_x_continuous(expand = c(0.005,0.005) )
for(tree in tree_sample){
dataframe_subset <- results_dataframe[results_dataframe$tree == tree,]
x <- dataframe_subset[,'parent_time']
y <- dataframe_subset[,paste(rate,'_to_child',sep='')]
factor <- factor(dataframe_subset[,'branch_is_terminal'])
pl <- pl + geom_point(data=data.frame(x,y,factor),
aes(x=x,y=y, colour = factor),
size = 4, alpha = 0.8)
}
pl
pl <- ggplot() +
# Internal: black (grey25), Terminal: 'royalblue1'
scale_colour_manual(values=c("grey25",'royalblue1')) +
xlab(paste("Time since MRCA (", time_units, ')', sep = '')) +
ylab(ylabel) +
ggplot_theme +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_blank(),
plot.title = element_text(hjust = 0.5, size = 10),
plot.margin = unit(c(1, 1, 1, 1),"cm")) +
scale_y_continuous(label=scientific_10, expand = c(0.005,0.001)) +
scale_x_continuous(expand = c(0.005,0.005) )
for(tree in tree_sample){
dataframe_subset <- results_dataframe[results_dataframe$tree == tree,]
x <- dataframe_subset[,'parent_time']
y <- dataframe_subset[,paste(rate,'_to_child',sep='')]
factor <- factor(dataframe_subset[,'branch_is_terminal'])
pl <- pl + geom_point(data=data.frame(x,y,factor),
aes(x=x,y=y, colour = factor),
size = 4, alpha = 0.8)
}
pl
pl <- ggplot() +
# Internal: black (grey25), Terminal: 'royalblue1'
scale_colour_manual(values=c("grey25",'royalblue1')) +
xlab(paste("Time since MRCA (", time_units, ')', sep = '')) +
ylab(ylabel) +
ggplot_theme +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_blank(),
plot.title = element_text(hjust = 0.5, size = 10),
plot.margin = unit(c(1, 1, 1, 1),"cm")) +
scale_y_continuous(label=scientific_10, expand = c(0.005,0.001)) +
scale_x_continuous(expand = c(0.005,0.005) )
for(tree in tree_sample){
dataframe_subset <- results_dataframe[results_dataframe$tree == tree,]
x <- dataframe_subset[,'parent_time']
y <- dataframe_subset[,paste(rate,'_to_child',sep='')]
factor <- factor(dataframe_subset[,'branch_is_terminal'])
pl <- pl + geom_point(data=data.frame(x,y,factor),
aes(x=x,y=y, colour = factor),
size = 4, alpha = 0.8)
}
pl
pl <- ggplot() +
# Internal: black (grey25), Terminal: 'royalblue1'
scale_colour_manual(values=c("grey25",'royalblue1')) +
xlab(paste("Time since MRCA (", time_units, ')', sep = '')) +
ylab(ylabel) +
ggplot_theme +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_blank(),
plot.title = element_text(hjust = 0.5, size = 10),
plot.margin = unit(c(1, 1, 1, 1),"cm")) +
scale_y_continuous(label=scientific_10, expand = c(0.006,0.001)) +
scale_x_continuous(expand = c(0.006,0.006) )
for(tree in tree_sample){
dataframe_subset <- results_dataframe[results_dataframe$tree == tree,]
x <- dataframe_subset[,'parent_time']
y <- dataframe_subset[,paste(rate,'_to_child',sep='')]
factor <- factor(dataframe_subset[,'branch_is_terminal'])
pl <- pl + geom_point(data=data.frame(x,y,factor),
aes(x=x,y=y, colour = factor),
size = 4, alpha = 0.8)
}
pl
base_plot_time <- function(results_dataframe, rate, time_units){
# Sample of 100 trees
sample_size <- 100
tree_sample <- sample(unique(results_dataframe$tree), sample_size, replace = F)
ylabel <- switch(rate,
total_rate = "Total substitution rate",
total_rate_RC = "Total substitution rate (RC)",
S_rate = "Synonymous substitution rate",
N_rate = "Non-synonymous rate")
# Plot:
pl <- ggplot() +
# Internal: black (grey25), Terminal: 'royalblue1'
scale_colour_manual(values=c("grey25",'royalblue1')) +
xlab(paste("Time since MRCA (", time_units, ')', sep = '')) +
ylab(ylabel) +
ggplot_theme +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_blank(),
plot.title = element_text(hjust = 0.5, size = 10),
plot.margin = unit(c(1, 1, 1, 1),"cm")) +
scale_y_continuous(label=scientific_10, expand = c(0.006,0.001)) +
scale_x_continuous(expand = c(0.006,0.006) )
for(tree in tree_sample){
dataframe_subset <- results_dataframe[results_dataframe$tree == tree,]
x <- dataframe_subset[,'parent_time']
y <- dataframe_subset[,paste(rate,'_to_child',sep='')]
factor <- factor(dataframe_subset[,'branch_is_terminal'])
pl <- pl + geom_point(data=data.frame(x,y,factor),
aes(x=x,y=y, colour = factor),
size = 4, alpha = 0.8)
}
return(pl)
}
plot_list_total_rate_RC <- c()
plot_list_S_rate <- c()
plot_list_N_rate <- c()
results_directory <- '../results/rates_vs_time/observed_lineages/'
clone_labels <- c('CH103 (H)', 'CH103 (L)', 'VRC26 (H)', 'VRC26 (L)',
'VRC01-13 (H)', 'VRC01-01 (H)', 'VRC01-19 (H)')
time_units <- c('weeks','weeks','weeks','weeks','months','months','months')
paths <- c('CH103_constant/CH103_con_run1a', 'CH103L_constant/CH103L_con_run1a',
'VRC26int_constant/VRC26int_con_run1a','VRC26L_constant/VRC26L_con_run1a',
'VRC01_13_logistic/VRC01_13_log_run1a','VRC01_01_logistic/VRC01_01_log_run1a',
'VRC01_19_logistic/VRC01_19_log_run1a'
)
paths <- paste(results_directory,paths,'_rates_vs_time_points.csv', sep = '')
for(i in 1:length(clone_labels)){
results_dataframe <- read.table(paths[i], header = T, sep = ',')
plot_list_total_rate_RC[[clone_labels[i]]] <- base_plot_time(results_dataframe, 'total_rate_RC', time_units = time_units[i])
plot_list_S_rate[[clone_labels[i]]] <- base_plot_time(results_dataframe, 'S_rate', time_units = time_units[i])
plot_list_N_rate[[clone_labels[i]]] <- base_plot_time(results_dataframe, 'N_rate', time_units = time_units[i])
}
plot_list_total_rate_RC <- c()
plot_list_S_rate <- c()
plot_list_N_rate <- c()
results_directory <- '../results/rates_vs_time/observed_lineages/'
clone_labels <- c('CH103 (H)', 'CH103 (L)', 'VRC26 (H)', 'VRC26 (L)',
'VRC01-13 (H)', 'VRC01-01 (H)', 'VRC01-19 (H)')
time_units <- c('weeks','weeks','weeks','weeks','months','months','months')
paths <- c('CH103_constant/CH103_con_run1a', 'CH103L_constant/CH103L_con_run1a',
'VRC26int_constant/VRC26int_con_run1a','VRC26L_constant/VRC26L_con_run1a',
'VRC01_13_logistic/VRC01_13_log_run1a','VRC01_01_logistic/VRC01_01_log_run1a',
'VRC01_19_logistic/VRC01_19_log_run1a'
)
paths <- paste(results_directory,paths,'_rates_vs_time_points.csv', sep = '')
for(i in 1:length(clone_labels)){
print(clone_labels[i])
results_dataframe <- read.table(paths[i], header = T, sep = ',')
plot_list_total_rate_RC[[clone_labels[i]]] <- base_plot_time(results_dataframe, 'total_rate_RC', time_units = time_units[i])
plot_list_S_rate[[clone_labels[i]]] <- base_plot_time(results_dataframe, 'S_rate', time_units = time_units[i])
plot_list_N_rate[[clone_labels[i]]] <- base_plot_time(results_dataframe, 'N_rate', time_units = time_units[i])
}
sample(unique(results_dataframe$tree), sample_size, replace = F)
results_dataframe
unique(results_dataframe$tree)
setwd("/Volumes/cobey/mvieira/evolution_of_mutability/figure_scripts")
library('ggplot2')
# Load ggplot parameters
source('ggplot_parameters.R')
points_file_path <- '../results/mutability_vs_time/observed_lineages/CH103_constant/CH103_con_run1a_mutability_vs_time_points.csv'
regressions_file_path <- '../results/mutability_vs_time/observed_lineages/CH103_constant/CH103_con_run1a_mutability_vs_time_correlations.csv'
