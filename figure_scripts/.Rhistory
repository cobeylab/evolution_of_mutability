theme_bw() +
ylab(paste('Synonymous change in mutability ', '(', region,')', sep = '')) +
xlab('Lineage') +
theme(legend.position = 'top',
legend.text=element_text(size=11)
) +
scale_y_continuous(limits = ylims) +
# Observed
geom_point(aes(y=mean_contrast_true), shape = 21, fill = 'gray80', alpha = 0.8,
size = 3) +
# Simulated under S5F model
geom_linerange(aes(ymin=contrast_simulation_S5F_S5F_llim,
ymax = contrast_simulation_S5F_S5F_ulim), colour = 'red4',
position = position_nudge(x=-0.1,y=0)) +
geom_point(aes(y=mean_contrast_simulation_S5F_S5F), shape = 21, fill = 'firebrick1', alpha = 0.8,
size = 3,position = position_nudge(x=-0.1,y=0))
return(pl)
}
base_plot(combined_dataframe, 'syn_only', 'WS', 'constrained', c(-0.01,0.01))
ggplot(ggplot_dataframe, aes(x = lineage, y = mean_contrast_true)) +
geom_hline(yintercept=0,linetype = 2) +
theme_bw() +
ylab(paste('Synonymous change in mutability ', '(', region,')', sep = '')) +
xlab('Lineage') +
theme(legend.position = 'top',
legend.text=element_text(size=11)
) +
scale_y_continuous(limits = ylims) +
# Observed
geom_point(aes(y=mean_contrast_true), shape = 21, fill = 'gray80', alpha = 0.8,
size = 3) +
# Simulated under S5F model
geom_linerange(aes(ymin=contrast_simulation_S5F_S5F_llim,
ymax = contrast_simulation_S5F_S5F_ulim), colour = 'red4',
position = position_nudge(x=-0.1,y=0)) +
geom_point(aes(y=mean_contrast_simulation_S5F_S5F), shape = 21, fill = 'firebrick1', alpha = 0.8,
size = 3,position = position_nudge(x=-0.1,y=0)) +
# Simulated under uniform model
geom_linerange(aes(ymin=contrast_simulation_uniform_S5F_llim,
ymax = contrast_simulation_uniform_S5F_ulim), colour = 'blue4',
position = position_nudge(x=0.1,y=0)) +
geom_point(aes(y=mean_contrast_simulation_uniform_S5F), shape = 21, fill = 'royalblue3', alpha = 0.8,
size = 3, position = position_nudge(x=0.1,y=0))
ggplot(ggplot_dataframe, aes(x = lineage, y = mean_contrast_true)) +
geom_hline(yintercept=0,linetype = 2) +
theme_bw() +
ylab(paste('Synonymous change in mutability ', '(', region,')', sep = '')) +
xlab('Lineage') +
theme(legend.position = 'top',
legend.text=element_text(size=11)
) +
scale_y_continuous(limits = ylims) +
# Observed
geom_point(aes(y=mean_contrast_true), shape = 21, fill = 'gray80', alpha = 0.8,
size = 3) +
# Simulated under S5F model
geom_linerange(aes(ymin=contrast_simulation_S5F_S5F_llim,
ymax = contrast_simulation_S5F_S5F_ulim), colour = 'red4',
position = position_nudge(x=-0.1,y=0)) +
geom_point(aes(y=mean_contrast_simulation_S5F_S5F), shape = 21, fill = 'firebrick1', alpha = 0.8,
size = 3,position = position_nudge(x=-0.1,y=0)) +
# Simulated under uniform model
geom_linerange(aes(ymin=contrast_simulation_uniform_S5F_llim,
ymax = contrast_simulation_uniform_S5F_ulim), colour = 'blue4',
position = position_nudge(x=0.1,y=0)) +
geom_point(aes(y=mean_contrast_simulation_uniform_S5F), shape = 21, fill = 'royalblue3', alpha = 0.8,
size = 3, position = position_nudge(x=0.1,y=0)) +
# Simulated under codon-position model
geom_linerange(aes(ymin=contrast_simulation_CP_S5F_llim,
ymax = contrast_simulation_CP_S5F_ulim), colour = 'skyblue',
position = position_nudge(x=0.2,y=0)) +
geom_point(aes(y=mean_contrast_simulation_CP_S5F), shape = 21, fill = 'skyblue', alpha = 0.8,
size = 3, position = position_nudge(x=0.2,y=0))
base_plot <- function(dataframe, substitution_class, region, simulation_type, ylims){
dataframe <- dataframe[dataframe$substitution_class == substitution_class & dataframe$region == region,]
# Generate dataframe to pass to ggplot
ggplot_dataframe <- data.frame(lineage = dataframe$lineage, mean_contrast_true = dataframe$mean_contrast_true,
mean_contrast_simulation_S5F_S5F = dataframe[,paste('mean_contrast_simulation_',simulation_type,'_S5F_S5F', sep = '')],
contrast_simulation_S5F_S5F_llim = dataframe[,paste('contrast_simulation_',simulation_type,'_S5F_S5F_llim', sep = '')],
contrast_simulation_S5F_S5F_ulim = dataframe[,paste('contrast_simulation_',simulation_type,'_S5F_S5F_ulim', sep = '')],
mean_contrast_simulation_uniform_S5F = dataframe[,paste('mean_contrast_simulation_',simulation_type,'_uniform_S5F', sep = '')],
contrast_simulation_uniform_S5F_llim = dataframe[,paste('contrast_simulation_',simulation_type,'_uniform_S5F_llim', sep = '')],
contrast_simulation_uniform_S5F_ulim = dataframe[,paste('contrast_simulation_',simulation_type,'_uniform_S5F_ulim', sep = '')],
mean_contrast_simulation_CP_S5F = dataframe[,paste('mean_contrast_simulation_',simulation_type,'_CP_S5F', sep = '')],
contrast_simulation_CP_S5F_llim = dataframe[,paste('contrast_simulation_',simulation_type,'_CP_S5F_llim', sep = '')],
contrast_simulation_CP_S5F_ulim = dataframe[,paste('contrast_simulation_',simulation_type,'_CP_S5F_ulim', sep = '')]
)
pl <- ggplot(ggplot_dataframe, aes(x = lineage, y = mean_contrast_true)) +
geom_hline(yintercept=0,linetype = 2) +
theme_bw() +
ylab(paste('Synonymous change in mutability ', '(', region,')', sep = '')) +
xlab('Lineage') +
theme(legend.position = 'top',
legend.text=element_text(size=11)
) +
scale_y_continuous(limits = ylims) +
# Observed
geom_point(aes(y=mean_contrast_true), shape = 21, fill = 'gray80', alpha = 0.8,
size = 3) +
# Simulated under S5F model
geom_linerange(aes(ymin=contrast_simulation_S5F_S5F_llim,
ymax = contrast_simulation_S5F_S5F_ulim), colour = 'red4',
position = position_nudge(x=-0.1,y=0)) +
geom_point(aes(y=mean_contrast_simulation_S5F_S5F), shape = 21, fill = 'firebrick1', alpha = 0.8,
size = 3,position = position_nudge(x=-0.1,y=0)) +
# Simulated under uniform model
geom_linerange(aes(ymin=contrast_simulation_uniform_S5F_llim,
ymax = contrast_simulation_uniform_S5F_ulim), colour = 'blue4',
position = position_nudge(x=0.1,y=0)) +
geom_point(aes(y=mean_contrast_simulation_uniform_S5F), shape = 21, fill = 'royalblue3', alpha = 0.8,
size = 3, position = position_nudge(x=0.1,y=0)) +
# Simulated under codon-position model
geom_linerange(aes(ymin=contrast_simulation_CP_S5F_llim,
ymax = contrast_simulation_CP_S5F_ulim), colour = 'skyblue',
position = position_nudge(x=0.2,y=0)) +
geom_point(aes(y=mean_contrast_simulation_CP_S5F), shape = 21, fill = 'skyblue', alpha = 0.8,
size = 3, position = position_nudge(x=0.2,y=0)) +
scale_x_discrete(labels = c('CH103' = 'CH103 (H)', 'CH103L' = 'CH103 (L)',
'VRC26' = 'VRC26 (H)', 'VRC26L' = 'VRC26 (L)',
'VRC01_13' = 'VRC01-13 (H)','VRC01_01' = 'VRC01-01 (H)',
'VRC01_19' = 'VRC01-19 (H)'
)) +
# Dummy points (plotted outside of plotting region, only purpose is to quickly produce ggplot legend)
geom_point(data = data.frame(lineage = c('CH103','CH103','CH103','CH103','CH103L','CH103L','CH103L','CH103L'),
change = c(10,10,10,10,10,10,10,10),
type = factor(c('observed','S5F model','uniform model','codon-position model',
'observed','S5F model','uniform model','codon-position model'),
levels = c('observed','S5F model','uniform model','codon-position model'))
),
aes(x = lineage, y = change, fill = type), shape = 21, size = 3
) +
scale_fill_manual(values = c('gray80', 'firebrick1', 'royalblue3','skyblue'),
labels = c('observed','S5F\nmodel','Uniform\nmodel','Codon-position\nmodel')) +
guides(fill=guide_legend(title=NULL))
return(pl)
}
base_plot(combined_dataframe, 'nonsyn_only', 'FR','unconstrained', c(-0.03,0.03))
base_plot <- function(dataframe, substitution_class, region, simulation_type, ylims = c(-0.03,0.03)){
dataframe <- dataframe[dataframe$substitution_class == substitution_class & dataframe$region == region,]
# Generate dataframe to pass to ggplot
ggplot_dataframe <- data.frame(lineage = dataframe$lineage, mean_contrast_true = dataframe$mean_contrast_true,
mean_contrast_simulation_S5F_S5F = dataframe[,paste('mean_contrast_simulation_',simulation_type,'_S5F_S5F', sep = '')],
contrast_simulation_S5F_S5F_llim = dataframe[,paste('contrast_simulation_',simulation_type,'_S5F_S5F_llim', sep = '')],
contrast_simulation_S5F_S5F_ulim = dataframe[,paste('contrast_simulation_',simulation_type,'_S5F_S5F_ulim', sep = '')],
mean_contrast_simulation_uniform_S5F = dataframe[,paste('mean_contrast_simulation_',simulation_type,'_uniform_S5F', sep = '')],
contrast_simulation_uniform_S5F_llim = dataframe[,paste('contrast_simulation_',simulation_type,'_uniform_S5F_llim', sep = '')],
contrast_simulation_uniform_S5F_ulim = dataframe[,paste('contrast_simulation_',simulation_type,'_uniform_S5F_ulim', sep = '')],
mean_contrast_simulation_CP_S5F = dataframe[,paste('mean_contrast_simulation_',simulation_type,'_CP_S5F', sep = '')],
contrast_simulation_CP_S5F_llim = dataframe[,paste('contrast_simulation_',simulation_type,'_CP_S5F_llim', sep = '')],
contrast_simulation_CP_S5F_ulim = dataframe[,paste('contrast_simulation_',simulation_type,'_CP_S5F_ulim', sep = '')]
)
pl <- ggplot(ggplot_dataframe, aes(x = lineage, y = mean_contrast_true)) +
geom_hline(yintercept=0,linetype = 2) +
theme_bw() +
ylab(paste('Synonymous change in mutability ', '(', region,')', sep = '')) +
xlab('Lineage') +
theme(legend.position = 'top',
legend.text=element_text(size=11)
) +
scale_y_continuous(limits = ylims) +
# Observed
geom_point(aes(y=mean_contrast_true), shape = 21, fill = 'gray80', alpha = 0.8,
size = 3) +
# Simulated under S5F model
geom_linerange(aes(ymin=contrast_simulation_S5F_S5F_llim,
ymax = contrast_simulation_S5F_S5F_ulim), colour = 'red4',
position = position_nudge(x=-0.1,y=0)) +
geom_point(aes(y=mean_contrast_simulation_S5F_S5F), shape = 21, fill = 'firebrick1', alpha = 0.8,
size = 3,position = position_nudge(x=-0.1,y=0)) +
# Simulated under uniform model
geom_linerange(aes(ymin=contrast_simulation_uniform_S5F_llim,
ymax = contrast_simulation_uniform_S5F_ulim), colour = 'blue4',
position = position_nudge(x=0.1,y=0)) +
geom_point(aes(y=mean_contrast_simulation_uniform_S5F), shape = 21, fill = 'royalblue3', alpha = 0.8,
size = 3, position = position_nudge(x=0.1,y=0)) +
# Simulated under codon-position model
geom_linerange(aes(ymin=contrast_simulation_CP_S5F_llim,
ymax = contrast_simulation_CP_S5F_ulim), colour = 'skyblue',
position = position_nudge(x=0.2,y=0)) +
geom_point(aes(y=mean_contrast_simulation_CP_S5F), shape = 21, fill = 'skyblue', alpha = 0.8,
size = 3, position = position_nudge(x=0.2,y=0)) +
scale_x_discrete(labels = c('CH103' = 'CH103 (H)', 'CH103L' = 'CH103 (L)',
'VRC26' = 'VRC26 (H)', 'VRC26L' = 'VRC26 (L)',
'VRC01_13' = 'VRC01-13 (H)','VRC01_01' = 'VRC01-01 (H)',
'VRC01_19' = 'VRC01-19 (H)'
)) +
# Dummy points (plotted outside of plotting region, only purpose is to quickly produce ggplot legend)
geom_point(data = data.frame(lineage = c('CH103','CH103','CH103','CH103','CH103L','CH103L','CH103L','CH103L'),
change = c(10,10,10,10,10,10,10,10),
type = factor(c('observed','S5F model','uniform model','codon-position model',
'observed','S5F model','uniform model','codon-position model'),
levels = c('observed','S5F model','uniform model','codon-position model'))
),
aes(x = lineage, y = change, fill = type), shape = 21, size = 3
) +
scale_fill_manual(values = c('gray80', 'firebrick1', 'royalblue3','skyblue'),
labels = c('observed','S5F\nmodel','Uniform\nmodel','Codon-position\nmodel')) +
guides(fill=guide_legend(title=NULL))
return(pl)
}
base_plot(combined_dataframe, 'syn_only', 'FR','unconstrained', c(-0.03,0.03))
base_plot(combined_dataframe, 'syn_only', 'CDR','unconstrained', c(-0.03,0.03))
base_plot(combined_dataframe, substitution_class = 'syn_only', region = 'WS',
simulation_type = 'unconstrained')
base_plot(combined_dataframe, substitution_class = 'syn_only', region = 'WS',
simulation_type = 'unconstrained', ylims = c(-0.01,0.01))
base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.01,0.01))
base_plot(combined_dataframe, substitution_class = 'syn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.01,0.01))
base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.01,0.01))
switch(substitution_class,
syn_only = 'Synonymous',
nonsyn_only = 'Non-synonymous',
total = 'Total')
base_plot <- function(dataframe, substitution_class, region, simulation_type, ylims = c(-0.03,0.03)){
dataframe <- dataframe[dataframe$substitution_class == substitution_class & dataframe$region == region,]
ylabel_subst_class <- switch(substitution_class,
syn_only = 'Synonymous',
nonsyn_only = 'Non-synonymous',
total = 'Total')
# Generate dataframe to pass to ggplot
ggplot_dataframe <- data.frame(lineage = dataframe$lineage, mean_contrast_true = dataframe$mean_contrast_true,
mean_contrast_simulation_S5F_S5F = dataframe[,paste('mean_contrast_simulation_',simulation_type,'_S5F_S5F', sep = '')],
contrast_simulation_S5F_S5F_llim = dataframe[,paste('contrast_simulation_',simulation_type,'_S5F_S5F_llim', sep = '')],
contrast_simulation_S5F_S5F_ulim = dataframe[,paste('contrast_simulation_',simulation_type,'_S5F_S5F_ulim', sep = '')],
mean_contrast_simulation_uniform_S5F = dataframe[,paste('mean_contrast_simulation_',simulation_type,'_uniform_S5F', sep = '')],
contrast_simulation_uniform_S5F_llim = dataframe[,paste('contrast_simulation_',simulation_type,'_uniform_S5F_llim', sep = '')],
contrast_simulation_uniform_S5F_ulim = dataframe[,paste('contrast_simulation_',simulation_type,'_uniform_S5F_ulim', sep = '')],
mean_contrast_simulation_CP_S5F = dataframe[,paste('mean_contrast_simulation_',simulation_type,'_CP_S5F', sep = '')],
contrast_simulation_CP_S5F_llim = dataframe[,paste('contrast_simulation_',simulation_type,'_CP_S5F_llim', sep = '')],
contrast_simulation_CP_S5F_ulim = dataframe[,paste('contrast_simulation_',simulation_type,'_CP_S5F_ulim', sep = '')]
)
pl <- ggplot(ggplot_dataframe, aes(x = lineage, y = mean_contrast_true)) +
geom_hline(yintercept=0,linetype = 2) +
theme_bw() +
ylab(paste(ylabel_subst_class, ' (', region,')', sep = '')) +
xlab('Lineage') +
theme(legend.position = 'top',
legend.text=element_text(size=11)
) +
scale_y_continuous(limits = ylims) +
# Observed
geom_point(aes(y=mean_contrast_true), shape = 21, fill = 'gray80', alpha = 0.8,
size = 3) +
# Simulated under S5F model
geom_linerange(aes(ymin=contrast_simulation_S5F_S5F_llim,
ymax = contrast_simulation_S5F_S5F_ulim), colour = 'red4',
position = position_nudge(x=-0.1,y=0)) +
geom_point(aes(y=mean_contrast_simulation_S5F_S5F), shape = 21, fill = 'firebrick1', alpha = 0.8,
size = 3,position = position_nudge(x=-0.1,y=0)) +
# Simulated under uniform model
geom_linerange(aes(ymin=contrast_simulation_uniform_S5F_llim,
ymax = contrast_simulation_uniform_S5F_ulim), colour = 'blue4',
position = position_nudge(x=0.1,y=0)) +
geom_point(aes(y=mean_contrast_simulation_uniform_S5F), shape = 21, fill = 'royalblue3', alpha = 0.8,
size = 3, position = position_nudge(x=0.1,y=0)) +
# Simulated under codon-position model
geom_linerange(aes(ymin=contrast_simulation_CP_S5F_llim,
ymax = contrast_simulation_CP_S5F_ulim), colour = 'skyblue',
position = position_nudge(x=0.2,y=0)) +
geom_point(aes(y=mean_contrast_simulation_CP_S5F), shape = 21, fill = 'skyblue', alpha = 0.8,
size = 3, position = position_nudge(x=0.2,y=0)) +
scale_x_discrete(labels = c('CH103' = 'CH103 (H)', 'CH103L' = 'CH103 (L)',
'VRC26' = 'VRC26 (H)', 'VRC26L' = 'VRC26 (L)',
'VRC01_13' = 'VRC01-13 (H)','VRC01_01' = 'VRC01-01 (H)',
'VRC01_19' = 'VRC01-19 (H)'
)) +
# Dummy points (plotted outside of plotting region, only purpose is to quickly produce ggplot legend)
geom_point(data = data.frame(lineage = c('CH103','CH103','CH103','CH103','CH103L','CH103L','CH103L','CH103L'),
change = c(10,10,10,10,10,10,10,10),
type = factor(c('observed','S5F model','uniform model','codon-position model',
'observed','S5F model','uniform model','codon-position model'),
levels = c('observed','S5F model','uniform model','codon-position model'))
),
aes(x = lineage, y = change, fill = type), shape = 21, size = 3
) +
scale_fill_manual(values = c('gray80', 'firebrick1', 'royalblue3','skyblue'),
labels = c('observed','S5F\nmodel','Uniform\nmodel','Codon-position\nmodel')) +
guides(fill=guide_legend(title=NULL))
return(pl)
}
base_plot(combined_dataframe, substitution_class = 'syn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.01,0.01))
base_plot <- function(dataframe, substitution_class, region, simulation_type, ylims = c(-0.03,0.03)){
dataframe <- dataframe[dataframe$substitution_class == substitution_class & dataframe$region == region,]
ylabel_subst_class <- switch(substitution_class,
syn_only = 'Synonymous change in mutability',
nonsyn_only = 'Non-synonymous change in mutability',
total = 'Total change in mutability')
# Generate dataframe to pass to ggplot
ggplot_dataframe <- data.frame(lineage = dataframe$lineage, mean_contrast_true = dataframe$mean_contrast_true,
mean_contrast_simulation_S5F_S5F = dataframe[,paste('mean_contrast_simulation_',simulation_type,'_S5F_S5F', sep = '')],
contrast_simulation_S5F_S5F_llim = dataframe[,paste('contrast_simulation_',simulation_type,'_S5F_S5F_llim', sep = '')],
contrast_simulation_S5F_S5F_ulim = dataframe[,paste('contrast_simulation_',simulation_type,'_S5F_S5F_ulim', sep = '')],
mean_contrast_simulation_uniform_S5F = dataframe[,paste('mean_contrast_simulation_',simulation_type,'_uniform_S5F', sep = '')],
contrast_simulation_uniform_S5F_llim = dataframe[,paste('contrast_simulation_',simulation_type,'_uniform_S5F_llim', sep = '')],
contrast_simulation_uniform_S5F_ulim = dataframe[,paste('contrast_simulation_',simulation_type,'_uniform_S5F_ulim', sep = '')],
mean_contrast_simulation_CP_S5F = dataframe[,paste('mean_contrast_simulation_',simulation_type,'_CP_S5F', sep = '')],
contrast_simulation_CP_S5F_llim = dataframe[,paste('contrast_simulation_',simulation_type,'_CP_S5F_llim', sep = '')],
contrast_simulation_CP_S5F_ulim = dataframe[,paste('contrast_simulation_',simulation_type,'_CP_S5F_ulim', sep = '')]
)
pl <- ggplot(ggplot_dataframe, aes(x = lineage, y = mean_contrast_true)) +
geom_hline(yintercept=0,linetype = 2) +
theme_bw() +
ylab(paste(ylabel_subst_class, ' (', region,')', sep = '')) +
xlab('Lineage') +
theme(legend.position = 'top',
legend.text=element_text(size=11)
) +
scale_y_continuous(limits = ylims) +
# Observed
geom_point(aes(y=mean_contrast_true), shape = 21, fill = 'gray80', alpha = 0.8,
size = 3) +
# Simulated under S5F model
geom_linerange(aes(ymin=contrast_simulation_S5F_S5F_llim,
ymax = contrast_simulation_S5F_S5F_ulim), colour = 'red4',
position = position_nudge(x=-0.1,y=0)) +
geom_point(aes(y=mean_contrast_simulation_S5F_S5F), shape = 21, fill = 'firebrick1', alpha = 0.8,
size = 3,position = position_nudge(x=-0.1,y=0)) +
# Simulated under uniform model
geom_linerange(aes(ymin=contrast_simulation_uniform_S5F_llim,
ymax = contrast_simulation_uniform_S5F_ulim), colour = 'blue4',
position = position_nudge(x=0.1,y=0)) +
geom_point(aes(y=mean_contrast_simulation_uniform_S5F), shape = 21, fill = 'royalblue3', alpha = 0.8,
size = 3, position = position_nudge(x=0.1,y=0)) +
# Simulated under codon-position model
geom_linerange(aes(ymin=contrast_simulation_CP_S5F_llim,
ymax = contrast_simulation_CP_S5F_ulim), colour = 'skyblue',
position = position_nudge(x=0.2,y=0)) +
geom_point(aes(y=mean_contrast_simulation_CP_S5F), shape = 21, fill = 'skyblue', alpha = 0.8,
size = 3, position = position_nudge(x=0.2,y=0)) +
scale_x_discrete(labels = c('CH103' = 'CH103 (H)', 'CH103L' = 'CH103 (L)',
'VRC26' = 'VRC26 (H)', 'VRC26L' = 'VRC26 (L)',
'VRC01_13' = 'VRC01-13 (H)','VRC01_01' = 'VRC01-01 (H)',
'VRC01_19' = 'VRC01-19 (H)'
)) +
# Dummy points (plotted outside of plotting region, only purpose is to quickly produce ggplot legend)
geom_point(data = data.frame(lineage = c('CH103','CH103','CH103','CH103','CH103L','CH103L','CH103L','CH103L'),
change = c(10,10,10,10,10,10,10,10),
type = factor(c('observed','S5F model','uniform model','codon-position model',
'observed','S5F model','uniform model','codon-position model'),
levels = c('observed','S5F model','uniform model','codon-position model'))
),
aes(x = lineage, y = change, fill = type), shape = 21, size = 3
) +
scale_fill_manual(values = c('gray80', 'firebrick1', 'royalblue3','skyblue'),
labels = c('observed','S5F\nmodel','Uniform\nmodel','Codon-position\nmodel')) +
guides(fill=guide_legend(title=NULL))
return(pl)
}
ase_plot(combined_dataframe, substitution_class = 'syn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.01,0.01))
base_plot(combined_dataframe, substitution_class = 'syn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.01,0.01))
base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.01,0.01))
pl_syn_CDR_unconstrained <-
base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.02,0.02))
base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.02,0.02))
base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.03,0.03))
base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.025,0.025))
base_plot(combined_dataframe, substitution_class = 'syn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.03,0.03))
base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.03,0.03))
base_plot(combined_dataframe, substitution_class = 'syn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.03,0.03))
base_plot(combined_dataframe, substitution_class = 'syn_only', region = 'CDR',
simulation_type = 'unconstrained', ylims = c(-0.03,0.03))
base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'CDR',
simulation_type = 'unconstrained', ylims = c(-0.03,0.03))
base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'CDR',
simulation_type = 'unconstrained', ylims = c(-0.035,0.01))
base_plot(combined_dataframe, substitution_class = 'syn_only', region = 'CDR',
simulation_type = 'unconstrained', ylims = c(-0.035,0.01))
base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.03,0.03))
base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.03,0.02))
pl_syn_FR_unconstrained <- base_plot(combined_dataframe, substitution_class = 'syn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.03,0.02))
pl_nonsyn_FR_unconstrained <- base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.03,0.02))
pl_syn_CDR_unconstrained <- base_plot(combined_dataframe, substitution_class = 'syn_only', region = 'CDR',
simulation_type = 'unconstrained', ylims = c(-0.035,0.01))
pl_nonsyn_CDR_unconstrained <- base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'CDR',
simulation_type = 'unconstrained', ylims = c(-0.035,0.01))
save_plot('randomization_figures/unconstrained.pdf',
plot_grid(pl_syn_FR_unconstrained, pl_nonsyn_FR_unconstrained,
pl_syn_CDR_unconstrained, pl_nonsyn_CDR_unconstrained,
labels = c("a)", "b)","c)","d)"), label_size = 20, nrow =2),
base_height = 10, base_width = 14
)
plot_grid(pl_syn_FR_unconstrained, pl_nonsyn_FR_unconstrained,
pl_syn_CDR_unconstrained, pl_nonsyn_CDR_unconstrained,
labels = c("a)", "b)","c)","d)"), label_size = 20, nrow =2)
pl_syn_FR_unconstrained <- base_plot(combined_dataframe, substitution_class = 'syn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.03,0.02))
pl_nonsyn_FR_unconstrained <- base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.03,0.02))
pl_syn_CDR_unconstrained <- base_plot(combined_dataframe, substitution_class = 'syn_only', region = 'CDR',
simulation_type = 'unconstrained', ylims = c(-0.035,0.01))
pl_nonsyn_CDR_unconstrained <- base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'CDR',
simulation_type = 'unconstrained', ylims = c(-0.035,0.01))
library(cowplot)
plot_grid(pl_syn_FR_unconstrained, pl_nonsyn_FR_unconstrained,
pl_syn_CDR_unconstrained, pl_nonsyn_CDR_unconstrained,
labels = c("a)", "b)","c)","d)"), label_size = 20, nrow =2)
dev.off()
plot_grid(pl_syn_FR_unconstrained, pl_nonsyn_FR_unconstrained,
pl_syn_CDR_unconstrained, pl_nonsyn_CDR_unconstrained,
labels = c("a)", "b)","c)","d)"), label_size = 20, nrow =2)
unconstrained_plot <- plot_grid(pl_syn_FR_unconstrained, pl_nonsyn_FR_unconstrained,
pl_syn_CDR_unconstrained, pl_nonsyn_CDR_unconstrained,
labels = c("a)", "b)","c)","d)"), label_size = 20, nrow =2)
save_plot('randomization_figures/unconstrained.pdf',
unconstrained_plot,
base_height = 10, base_width = 14
)
save_plot('randomization_figures/unconstrained.pdf',
unconstrained_plot,
base_height = 10, base_width = 12
)
save_plot('randomization_figures/unconstrained.pdf',
unconstrained_plot,
base_height = 12, base_width = 14
)
pl_syn_WS_unconstrained <- base_plot(combined_dataframe, substitution_class = 'syn_only', region = 'WS',
simulation_type = 'unconstrained', ylims = c(-0.03,0.02))
pl_nonsyn_WS_unconstrained <- base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'WS',
simulation_type = 'unconstrained', ylims = c(-0.03,0.02))
pl_syn_FR_unconstrained <- base_plot(combined_dataframe, substitution_class = 'syn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.03,0.02))
pl_nonsyn_FR_unconstrained <- base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.03,0.02))
pl_syn_CDR_unconstrained <- base_plot(combined_dataframe, substitution_class = 'syn_only', region = 'CDR',
simulation_type = 'unconstrained', ylims = c(-0.035,0.01))
pl_nonsyn_CDR_unconstrained <- base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'CDR',
simulation_type = 'unconstrained', ylims = c(-0.035,0.01))
pl_syn_WS_unconstrained <- base_plot(combined_dataframe, substitution_class = 'syn_only', region = 'WS',
simulation_type = 'unconstrained', ylims = c(-0.03,0.02))
pl_nonsyn_WS_unconstrained <- base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'WS',
simulation_type = 'unconstrained', ylims = c(-0.03,0.02))
pl_syn_FR_unconstrained <- base_plot(combined_dataframe, substitution_class = 'syn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.03,0.02))
pl_nonsyn_FR_unconstrained <- base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'FR',
simulation_type = 'unconstrained', ylims = c(-0.03,0.02))
pl_syn_CDR_unconstrained <- base_plot(combined_dataframe, substitution_class = 'syn_only', region = 'CDR',
simulation_type = 'unconstrained', ylims = c(-0.035,0.01))
pl_nonsyn_CDR_unconstrained <- base_plot(combined_dataframe, substitution_class = 'nonsyn_only', region = 'CDR',
simulation_type = 'unconstrained', ylims = c(-0.035,0.01))
unconstrained_plot <- plot_grid(pl_syn_WS_unconstrained, pl_nonsyn_WS_unconstrained,
pl_syn_FR_unconstrained, pl_nonsyn_FR_unconstrained,
pl_syn_CDR_unconstrained, pl_nonsyn_CDR_unconstrained,
labels = c("a)", "b)","c)","d)","e)","f)"), label_size = 20, nrow =2)
save_plot('randomization_figures/unconstrained.pdf',
unconstrained_plot,
base_height = 12, base_width = 14
)
save_plot('randomization_figures/unconstrained.pdf',
unconstrained_plot,
base_height = 14, base_width = 18
)
unconstrained_plot <- plot_grid(pl_syn_WS_unconstrained, pl_nonsyn_WS_unconstrained,
pl_syn_FR_unconstrained, pl_nonsyn_FR_unconstrained,
pl_syn_CDR_unconstrained, pl_nonsyn_CDR_unconstrained,
labels = c("a)", "b)","c)","d)","e)","f)"), label_size = 20, nrow =3)
save_plot('randomization_figures/unconstrained.pdf',
unconstrained_plot,
base_height = 14, base_width = 18
)
save_plot('randomization_figures/unconstrained.pdf',
unconstrained_plot,
base_height = 18, base_width = 14
)
unconstrained_plot <- plot_grid(pl_syn_WS_unconstrained, pl_nonsyn_WS_unconstrained,
pl_syn_FR_unconstrained, pl_nonsyn_FR_unconstrained,
pl_syn_CDR_unconstrained, pl_nonsyn_CDR_unconstrained,
labels = c("Whole sequence", "","FRs","","CDRs",""), label_size = 20, nrow =3)
save_plot('randomization_figures/unconstrained.pdf',
unconstrained_plot,
base_height = 18, base_width = 14
)
?plot_grid
unconstrained_plot <- plot_grid(pl_syn_WS_unconstrained, pl_nonsyn_WS_unconstrained,
pl_syn_FR_unconstrained, pl_nonsyn_FR_unconstrained,
pl_syn_CDR_unconstrained, pl_nonsyn_CDR_unconstrained,
labels = c("Whole sequence", "","FRs","","CDRs",""),
label_size = 20, nrow =3, hjust = 0)
save_plot('randomization_figures/unconstrained.pdf',
unconstrained_plot,
base_height = 18, base_width = 14
)
unconstrained_plot <- plot_grid(pl_syn_WS_unconstrained, pl_nonsyn_WS_unconstrained,
pl_syn_FR_unconstrained, pl_nonsyn_FR_unconstrained,
pl_syn_CDR_unconstrained, pl_nonsyn_CDR_unconstrained,
labels = c("Whole sequence", "","FRs","","CDRs",""),
label_size = 15, nrow =3, hjust = 0)
save_plot('randomization_figures/unconstrained.pdf',
unconstrained_plot,
base_height = 18, base_width = 14
)
base_plot(combined_dataframe, substitution_class = 'total', region = 'WS',simulation_type = 'unconstrained')
base_plot(combined_dataframe, substitution_class = 'total', region = 'WS',simulation_type = 'unconstrained', c(-0.3,0.02))
base_plot(combined_dataframe, substitution_class = 'total', region = 'WS',simulation_type = 'unconstrained', c(-0.03,0.02))
base_plot(combined_dataframe, substitution_class = 'total', region = 'WS',simulation_type = 'unconstrained', c(-0.035,0.02))
