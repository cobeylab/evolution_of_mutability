)
)
}
# Plot with separate results for terminal and internal branches
pl_terminal_vs_internal <- pl +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_terminal, ymax = HPD_ulim_terminal),
colour = 'blue') +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_terminal),
shape = 21, fill = 'royalblue1', alpha = 0.7,size = 2.5)  +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_internal, ymax = HPD_ulim_internal),
colour = 'grey40', position = position_nudge(x=-0.3,y=0)) +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_internal),
shape = 21, fill = 'grey25', alpha = 0.7,size = 2.5,
position = position_nudge(x=-0.3,y=0)) +
# Artificial points plotted outside of plotting region, only purpose is to quickly produce ggplot legend
geom_pointrange(data = data.frame(lineage = c('CH103','CH103','CH103L','CH103L'),
change = c(0.1,0.1,0.1,0.1),
type = factor(c('Internal branches','Terminal branches',
'Internal branches','Terminal branches'),
levels = c('Internal branches','Terminal branches'))
),
aes(x = lineage, y = change, ymin = change, ymax = change, colour = type, fill = type),
shape = 21, size = 1, alpha = 0.7) +
scale_colour_manual(values = c('grey25','royalblue1'),
labels = c('Internal\nbranches','Terminal\nbranches')) +
scale_fill_manual(values = c('grey25','royalblue1'),
labels = c('Internal\nbranches','Terminal\nbranches')) +
guides(colour=guide_legend(title=NULL)) +
guides(fill=guide_legend(title=NULL)) +
scale_x_discrete(labels=x_labels)
####
pdf('syn_S5F_changes_terminal_vs_internal.pdf',width = 6, height = 4.5)
plot(pl_terminal_vs_internal)
dev.off()
####
# Base Plot
pl <- ggplot(data = subset(summary_dataframe, region != 'WS'),
aes(x=lineage,y=mean_fraction_negative_internal)) +
scale_y_continuous(expand = c(0,0), limits = c(-0.05,1.05)) +
theme_bw() +
#theme_classic() +
ylab('Frequency of mutability losses') +
xlab('Lineage') +
ggplot_theme +
theme(axis.text.x = element_text(angle = 90,vjust=0.6, size = 9),
legend.position = 'top',
legend.text=element_text(size=11),
axis.title.x = element_text(size = 13),
strip.text.x = element_text(size = 13)
) +
# Add violin plots
#geom_violin(size = 0.6, colour = 'gray40') +
#geom_boxplot(colour = 'gray40') +
# Add horizontal line at 0.5
geom_hline(yintercept=0.5,linetype=5, size = 0.5) +
facet_grid(.~region, labeller = labeller(region = region_names)) +
theme(panel.margin.y = unit(1.3, 'lines'))
# Change x-axis labels
x_labels <- c()
for(level in levels(global_dataframe$lineage)){
x_labels <- c(x_labels,
switch(level,
CH103 = 'CH103 (H)',
CH103L = 'CH103 (L)',
VRC26int = 'VRC26 (H)',
VRC26 = 'VRC26 (H)',
VRC26L = 'VRC26 (L)',
VRC01_13 = 'VRC01-13(H)',
VRC01_01 = 'VRC01-01(H)',
VRC01_19 = 'VRC01-19(H)'
)
)
}
# Plot with separate results for terminal and internal branches
pl_terminal_vs_internal <- pl +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_terminal, ymax = HPD_ulim_terminal),
colour = 'blue') +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_terminal),
shape = 21, fill = 'royalblue1', alpha = 0.7,size = 2.5)  +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_internal, ymax = HPD_ulim_internal),
colour = 'grey40', position = position_nudge(x=-0.3,y=0)) +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_internal),
shape = 21, fill = 'grey25', alpha = 0.7,size = 2.5,
position = position_nudge(x=-0.3,y=0)) +
# Artificial points plotted outside of plotting region, only purpose is to quickly produce ggplot legend
geom_pointrange(data = data.frame(lineage = c('CH103','CH103','CH103L','CH103L'),
change = c(0.1,0.1,0.1,0.1),
type = factor(c('Internal branches','Terminal branches',
'Internal branches','Terminal branches'),
levels = c('Internal branches','Terminal branches'))
),
aes(x = lineage, y = change, ymin = change, ymax = change, colour = type, fill = type),
shape = 21, size = 1, alpha = 0.7) +
scale_colour_manual(values = c('grey25','royalblue1'),
labels = c('Internal\nbranches','Terminal\nbranches')) +
scale_fill_manual(values = c('grey25','royalblue1'),
labels = c('Internal\nbranches','Terminal\nbranches')) +
guides(colour=guide_legend(title=NULL)) +
guides(fill=guide_legend(title=NULL)) +
scale_x_discrete(labels=x_labels)
####
pdf('syn_S5F_changes_terminal_vs_internal.pdf',width = 6, height = 4.5)
plot(pl_terminal_vs_internal)
dev.off()
####
pl <- ggplot(data = subset(summary_dataframe, region != 'WS'),
aes(x=lineage,y=mean_fraction_negative_internal)) +
scale_y_continuous(expand = c(0,0), limits = c(-0.05,1.05)) +
theme_bw() +
#theme_classic() +
ylab('Frequency of mutability losses') +
xlab('Lineage') +
ggplot_theme +
theme(axis.text.x = element_text(angle = 90,vjust=0.6, size = 9),
legend.position = 'top',
legend.text=element_text(size=11),
axis.title.x = element_text(size = 13),
strip.text.x = element_text(size = 13)
) +
# Add violin plots
#geom_violin(size = 0.6, colour = 'gray40') +
#geom_boxplot(colour = 'gray40') +
# Add horizontal line at 0.5
geom_hline(yintercept=0.5,linetype=5, size = 0.5) +
facet_grid(.~region, labeller = labeller(region = region_names)) +
theme(panel.margin.y = unit(1.3, 'lines'))
# Change x-axis labels
x_labels <- c()
for(level in levels(global_dataframe$lineage)){
x_labels <- c(x_labels,
switch(level,
CH103 = 'CH103 (H)',
CH103L = 'CH103 (L)',
VRC26int = 'VRC26 (H)',
VRC26 = 'VRC26 (H)',
VRC26L = 'VRC26 (L)',
VRC01_13 = 'VRC01-13(H)',
VRC01_01 = 'VRC01-01(H)',
VRC01_19 = 'VRC01-19(H)'
)
)
}
# Plot with separate results for terminal and internal branches
pl_terminal_vs_internal <- pl +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_terminal, ymax = HPD_ulim_terminal),
colour = 'blue') +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_terminal),
shape = 21, fill = 'royalblue1', alpha = 0.7,size = 2.5)  +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_internal, ymax = HPD_ulim_internal),
colour = 'grey40', position = position_nudge(x=-0.3,y=0)) +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_internal),
shape = 21, fill = 'grey25', alpha = 0.7,size = 2.5,
position = position_nudge(x=-0.3,y=0)) +
# Artificial points plotted outside of plotting region, only purpose is to quickly produce ggplot legend
geom_pointrange(data = data.frame(lineage = c('CH103','CH103','CH103L','CH103L'),
change = c(-0.1,-0.1,-0.1,-0.1),
type = factor(c('Internal branches','Terminal branches',
'Internal branches','Terminal branches'),
levels = c('Internal branches','Terminal branches'))
),
aes(x = lineage, y = change, ymin = change, ymax = change, colour = type, fill = type),
shape = 21, size = 1, alpha = 0.7) +
scale_colour_manual(values = c('grey25','royalblue1'),
labels = c('Internal\nbranches','Terminal\nbranches')) +
scale_fill_manual(values = c('grey25','royalblue1'),
labels = c('Internal\nbranches','Terminal\nbranches')) +
guides(colour=guide_legend(title=NULL)) +
guides(fill=guide_legend(title=NULL)) +
scale_x_discrete(labels=x_labels)
####
pdf('syn_S5F_changes_terminal_vs_internal.pdf',width = 6, height = 4.5)
plot(pl_terminal_vs_internal)
dev.off()
####
####
pdf('syn_S5F_changes_terminal_vs_internal.pdf',width = 5.5, height = 4.5)
plot(pl_terminal_vs_internal)
dev.off()
####
####
pdf('syn_S5F_changes_terminal_vs_internal.pdf',width = 5.7, height = 4.5)
plot(pl_terminal_vs_internal)
dev.off()
####
####
pdf('syn_S5F_changes_terminal_vs_internal.pdf',width = 5.8, height = 4.5)
plot(pl_terminal_vs_internal)
dev.off()
####
pdf('syn_S5F_changes_terminal_vs_internal.pdf',width = 5.9, height = 4.5)
plot(pl_terminal_vs_internal)
dev.off()
####
pl_terminal_vs_internal <- pl +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_terminal, ymax = HPD_ulim_terminal),
colour = 'blue') +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_terminal),
shape = 21, fill = 'royalblue1', alpha = 0.7,size = 3)  +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_internal, ymax = HPD_ulim_internal),
colour = 'grey40', position = position_nudge(x=-0.3,y=0)) +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_internal),
shape = 21, fill = 'grey25', alpha = 0.7,size = 3,
position = position_nudge(x=-0.3,y=0)) +
# Artificial points plotted outside of plotting region, only purpose is to quickly produce ggplot legend
geom_pointrange(data = data.frame(lineage = c('CH103','CH103','CH103L','CH103L'),
change = c(-0.1,-0.1,-0.1,-0.1),
type = factor(c('Internal branches','Terminal branches',
'Internal branches','Terminal branches'),
levels = c('Internal branches','Terminal branches'))
),
aes(x = lineage, y = change, ymin = change, ymax = change, colour = type, fill = type),
shape = 21, size = 1, alpha = 0.7) +
scale_colour_manual(values = c('grey25','royalblue1'),
labels = c('Internal\nbranches','Terminal\nbranches')) +
scale_fill_manual(values = c('grey25','royalblue1'),
labels = c('Internal\nbranches','Terminal\nbranches')) +
guides(colour=guide_legend(title=NULL)) +
guides(fill=guide_legend(title=NULL)) +
scale_x_discrete(labels=x_labels)
####
pdf('syn_S5F_changes_terminal_vs_internal.pdf',width = 5.9, height = 4.5)
plot(pl_terminal_vs_internal)
dev.off()
####
pl_terminal_vs_internal <- pl +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_terminal, ymax = HPD_ulim_terminal),
colour = 'blue') +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_terminal),
shape = 21, fill = 'royalblue1', alpha = 0.7,size = 2.5)  +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_internal, ymax = HPD_ulim_internal),
colour = 'grey40', position = position_nudge(x=-0.3,y=0)) +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_internal),
shape = 21, fill = 'grey25', alpha = 0.7,size = 2.5,
position = position_nudge(x=-0.3,y=0)) +
# Artificial points plotted outside of plotting region, only purpose is to quickly produce ggplot legend
geom_pointrange(data = data.frame(lineage = c('CH103','CH103','CH103L','CH103L'),
change = c(-0.1,-0.1,-0.1,-0.1),
type = factor(c('Internal branches','Terminal branches',
'Internal branches','Terminal branches'),
levels = c('Internal branches','Terminal branches'))
),
aes(x = lineage, y = change, ymin = change, ymax = change, colour = type, fill = type),
shape = 21, size = 1, alpha = 0.7) +
scale_colour_manual(values = c('grey25','royalblue1'),
labels = c('Internal\nbranches','Terminal\nbranches')) +
scale_fill_manual(values = c('grey25','royalblue1'),
labels = c('Internal\nbranches','Terminal\nbranches')) +
guides(colour=guide_legend(title=NULL)) +
guides(fill=guide_legend(title=NULL)) +
scale_x_discrete(labels=x_labels)
####
pdf('syn_S5F_changes_terminal_vs_internal.pdf',width = 5.9, height = 4.5)
plot(pl_terminal_vs_internal)
dev.off()
####
pl +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_trunk, ymax = HPD_ulim_trunk),
colour = 'darkorange2') +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_terminal),
shape = 21, fill = 'darkorange3', alpha = 0.7,size = 2.5) +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_terminal, ymax = HPD_ulim_terminal),
colour = 'blue') +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_terminal),
shape = 21, fill = 'royalblue1', alpha = 0.7,size = 2.5)  +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_nontrunk, ymax = HPD_ulim_nontrunk),
colour = 'grey40', position = position_nudge(x=-0.3,y=0)) +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_nontrunk),
shape = 21, fill = 'grey25', alpha = 0.7,size = 2.5,
position = position_nudge(x=-0.3,y=0))
pl +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_trunk, ymax = HPD_ulim_trunk),
colour = 'darkorange2') +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_trunk),
shape = 21, fill = 'darkorange3', alpha = 0.7,size = 2.5) +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_terminal, ymax = HPD_ulim_terminal),
colour = 'blue') +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_terminal),
shape = 21, fill = 'royalblue1', alpha = 0.7,size = 2.5)  +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_nontrunk, ymax = HPD_ulim_nontrunk),
colour = 'grey40', position = position_nudge(x=-0.3,y=0)) +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_nontrunk),
shape = 21, fill = 'grey25', alpha = 0.7,size = 2.5,
position = position_nudge(x=-0.3,y=0))
pl +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_trunk, ymax = HPD_ulim_trunk),
colour = 'darkorange2', position = position_nudge(x=0.3,y=0)) +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_trunk),
shape = 21, fill = 'darkorange3', alpha = 0.7,size = 2.5, position = position_nudge(x=0.3,y=0)) +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_terminal, ymax = HPD_ulim_terminal),
colour = 'blue') +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_terminal),
shape = 21, fill = 'royalblue1', alpha = 0.7,size = 2.5)  +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_nontrunk, ymax = HPD_ulim_nontrunk),
colour = 'grey40', position = position_nudge(x=-0.3,y=0)) +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_nontrunk),
shape = 21, fill = 'grey25', alpha = 0.7,size = 2.5,
position = position_nudge(x=-0.3,y=0))
pl +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_trunk, ymax = HPD_ulim_trunk),
colour = 'darkorange2', position = position_nudge(x=0.2,y=0)) +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_trunk),
shape = 21, fill = 'darkorange3', alpha = 0.7,size = 2.5, position = position_nudge(x=0.2,y=0)) +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_terminal, ymax = HPD_ulim_terminal),
colour = 'blue') +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_terminal),
shape = 21, fill = 'royalblue1', alpha = 0.7,size = 2.5)  +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_nontrunk, ymax = HPD_ulim_nontrunk),
colour = 'grey40', position = position_nudge(x=-0.2,y=0)) +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_nontrunk),
shape = 21, fill = 'grey25', alpha = 0.7,size = 2.5,
position = position_nudge(x=-023,y=0))
pl +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_trunk, ymax = HPD_ulim_trunk),
colour = 'darkorange2', position = position_nudge(x=0.2,y=0)) +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_trunk),
shape = 21, fill = 'darkorange3', alpha = 0.7,size = 2.5, position = position_nudge(x=0.2,y=0)) +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_terminal, ymax = HPD_ulim_terminal),
colour = 'blue') +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_terminal),
shape = 21, fill = 'royalblue1', alpha = 0.7,size = 2.5)  +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_nontrunk, ymax = HPD_ulim_nontrunk),
colour = 'grey40', position = position_nudge(x=-0.2,y=0)) +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_nontrunk),
shape = 21, fill = 'grey25', alpha = 0.7,size = 2.5,
position = position_nudge(x=-02,y=0))
pl +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_trunk, ymax = HPD_ulim_trunk),
colour = 'darkorange2', position = position_nudge(x=0.2,y=0)) +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_trunk),
shape = 21, fill = 'darkorange3', alpha = 0.7,size = 2.5, position = position_nudge(x=0.2,y=0)) +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_terminal, ymax = HPD_ulim_terminal),
colour = 'blue') +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_terminal),
shape = 21, fill = 'royalblue1', alpha = 0.7,size = 2.5)  +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_nontrunk, ymax = HPD_ulim_nontrunk),
colour = 'grey40', position = position_nudge(x=-0.2,y=0)) +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_nontrunk),
shape = 21, fill = 'grey25', alpha = 0.7,size = 2.5,
position = position_nudge(x=-0.2,y=0))
pl +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_trunk, ymax = HPD_ulim_trunk),
colour = 'darkorange2', position = position_nudge(x=0.2,y=0)) +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_trunk),
shape = 21, fill = 'darkorange3', alpha = 0.7,size = 2.5, position = position_nudge(x=0.2,y=0)) +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_terminal, ymax = HPD_ulim_terminal),
colour = 'blue') +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_terminal),
shape = 21, fill = 'royalblue1', alpha = 0.7,size = 2.5)  +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_nontrunk, ymax = HPD_ulim_nontrunk),
colour = 'grey40', position = position_nudge(x=-0.2,y=0)) +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_nontrunk),
shape = 21, fill = 'grey25', alpha = 0.7,size = 2.5,
position = position_nudge(x=-0.2,y=0)) +
# Artificial points plotted outside of plotting region, only purpose is to quickly produce ggplot legend
geom_pointrange(data = data.frame(lineage = c('CH103','CH103','CH103','CH103L','CH103L','CH103L'),
change = c(-0.1,-0.1,-0.1,-0.1,-0.1,-0.1),
type = factor(c('Internal branches','trunk','Terminal branches',
'Internal branches','trunk','Terminal branches'),
levels = c('Internal branches','trunk','Terminal branches'))
),
aes(x = lineage, y = change, ymin = change, ymax = change, colour = type, fill = type), shape = 21, size = 1) +
scale_colour_manual(values = c('royalblue1','darkorange2','grey25'),
labels = c('Terminal\nbranches','Trunk','Non-trunk\ninternal branches')) +
scale_fill_manual(values = c('royalblue1','darkorange2','grey25'),
labels =  c('Terminal\nbranches','Trunk','Non-trunk\ninternal branches')) +
guides(colour=guide_legend(title=NULL)) +
guides(fill=guide_legend(title=NULL)) +
scale_x_discrete(labels=x_labels)
pl +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_trunk, ymax = HPD_ulim_trunk),
colour = 'darkorange2', position = position_nudge(x=0.2,y=0)) +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_trunk),
shape = 21, fill = 'darkorange3', alpha = 0.7,size = 2.5, position = position_nudge(x=0.2,y=0)) +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_terminal, ymax = HPD_ulim_terminal),
colour = 'blue') +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_terminal),
shape = 21, fill = 'royalblue1', alpha = 0.7,size = 2.5)  +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_nontrunk, ymax = HPD_ulim_nontrunk),
colour = 'grey40', position = position_nudge(x=-0.2,y=0)) +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_nontrunk),
shape = 21, fill = 'grey25', alpha = 0.7,size = 2.5,
position = position_nudge(x=-0.2,y=0)) +
# Artificial points plotted outside of plotting region, only purpose is to quickly produce ggplot legend
geom_pointrange(data = data.frame(lineage = c('CH103','CH103','CH103','CH103L','CH103L','CH103L'),
change = c(-0.1,-0.1,-0.1,-0.1,-0.1,-0.1),
type = factor(c('Internal branches','trunk','Terminal branches',
'Internal branches','trunk','Terminal branches'),
levels = c('Internal branches','trunk','Terminal branches'))
),
aes(x = lineage, y = change, ymin = change, ymax = change, colour = type, fill = type),
shape = 21, size = 1, alpha = 0.7) +
scale_colour_manual(values = c('royalblue1','darkorange2','grey25'),
labels = c('Terminal\nbranches','Trunk','Non-trunk\ninternal branches')) +
scale_fill_manual(values = c('royalblue1','darkorange2','grey25'),
labels =  c('Terminal\nbranches','Trunk','Non-trunk\ninternal branches')) +
guides(colour=guide_legend(title=NULL)) +
guides(fill=guide_legend(title=NULL)) +
scale_x_discrete(labels=x_labels)
####
pdf('syn_S5F_changes_trunk_vs_nontrunk.pdf', width = 5.9, height = 4.5)
plot(pl_trunk_vs_nontrunk)
dev.off()
####
pl_trunk_vs_nontrunk <- pl +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_trunk, ymax = HPD_ulim_trunk),
colour = 'darkorange2', position = position_nudge(x=0.2,y=0)) +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_trunk),
shape = 21, fill = 'darkorange3', alpha = 0.7,size = 2.5, position = position_nudge(x=0.2,y=0)) +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_terminal, ymax = HPD_ulim_terminal),
colour = 'blue') +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_terminal),
shape = 21, fill = 'royalblue1', alpha = 0.7,size = 2.5)  +
geom_linerange(data=subset(summary_dataframe, region != 'WS'),
aes(ymin=HPD_llim_nontrunk, ymax = HPD_ulim_nontrunk),
colour = 'grey40', position = position_nudge(x=-0.2,y=0)) +
geom_point(data=subset(summary_dataframe, region != 'WS'),
aes(y=mean_fraction_negative_nontrunk),
shape = 21, fill = 'grey25', alpha = 0.7,size = 2.5,
position = position_nudge(x=-0.2,y=0)) +
# Artificial points plotted outside of plotting region, only purpose is to quickly produce ggplot legend
geom_pointrange(data = data.frame(lineage = c('CH103','CH103','CH103','CH103L','CH103L','CH103L'),
change = c(-0.1,-0.1,-0.1,-0.1,-0.1,-0.1),
type = factor(c('Internal branches','trunk','Terminal branches',
'Internal branches','trunk','Terminal branches'),
levels = c('Internal branches','trunk','Terminal branches'))
),
aes(x = lineage, y = change, ymin = change, ymax = change, colour = type, fill = type),
shape = 21, size = 1, alpha = 0.7) +
scale_colour_manual(values = c('royalblue1','darkorange2','grey25'),
labels = c('Terminal\nbranches','Trunk','Non-trunk\ninternal branches')) +
scale_fill_manual(values = c('royalblue1','darkorange2','grey25'),
labels =  c('Terminal\nbranches','Trunk','Non-trunk\ninternal branches')) +
guides(colour=guide_legend(title=NULL)) +
guides(fill=guide_legend(title=NULL)) +
scale_x_discrete(labels=x_labels)
####
pdf('syn_S5F_changes_trunk_vs_nontrunk.pdf', width = 5.9, height = 4.5)
plot(pl_trunk_vs_nontrunk)
dev.off()
####
